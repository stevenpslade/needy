<div class="container">
    <h3 class="show-label"><%= @task.title %></h3>
  <div class="row">
    <!-- if TASK.NEEDED_ID is not present, then continue displaying the number of request and who has requested the task -->
    <% if @task.needed_id == nil %>
      <div class="top-content col s4">
        <img class="task-user-image" src="<%= @task.image_url %>"/>
        <p>Needy user: <%= User.find(@task.user_id).full_name %></p>
      </div>


  <!-- MAP RENDER -->
      <!-- <div class=" top-content col s4">
        <div><%= render 'map/tasks/map' %></div>
      </div> -->

      <div class="top-content col s4">
        <% all_requests = Request.where(task_id: @task.id) %>
        <p>There are currently <%= all_requests.count %> users requesting to do this job! Click to view their profile.</p>
        <p>
          <small>| 
            <% all_requests.each do |request| %>
              <% requester = User.find(request.user_id) %>
              <%= link_to requester.full_name, user_path(request.user_id) %> | 
            <% end %>
          </small>
        </p>
        <% if current_user.id == @task.user_id %>
        <p>Select one of the Needed's below and approve their request!</p>
          <!-- APPROVAL STUFF SHOULD GO HERE --> 
          <%= form_for @task do |f|%>
            <% all_requests.each do |r| %>
              <p>
                <input name="needed_id" type="radio" id="<%= r[:user_id] %>" value="<%= r[:user_id] %>"  /> 
                <label for="<%= r[:user_id] %>"><%= User.find(r[:user_id]).full_name %></label>
              </p>
            <% end %>
              <%= f.submit("Approve Request", name: nil) %>
          <% end %>
        <% end %>
      </div>
    <% else %>
    <!-- if the CURRENT USER is the user who POSTED the TASK -->
      <div class="top-content col s6">
        <img class="task-user-image" src="<%= @task.image_url %>"/>
      <% if @task.needed_id == nil %>
        <p>Needy user: <%= User.find(@task.user_id).full_name %></p>
        <p>Needed user: <%= User.find(@task.needed_id).full_name %></p>
      <% else %>
        <p>Needy user: <%= User.find(@task.user_id).full_name %></p>
        <p>Needed user: <span>Pending</span></p>
      <% end %>
      </div>
    <% end %>
    </div>
    <div class="row task-icons">
      <div class="col s12">
        <div class="card blue-grey darken-1">
          <div class="col s4">
            <i class="material-icons large">tune</i>
            <p><%= @task.difficulty %></p>
          </div>
          <div class="col s4">
            <i class="material-icons large">access_alarms</i>
            <p><%= @task.estimated_duration %> min</p>
          </div>
          <div class="col s4">
            <i class="material-icons large">adb</i>
            <p>$<%= @task.compensation %></p>
          </div>
        <div class="card-action">
          <a id="start">Start Task</a>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col s6">
        <h5 class="show-label">Description: </h5><h5 class="center-align"><%= @task.description %></h5>
      </div>
      <div class="col s6">
        <button id="show-review" class="btn waves-effect waves-light" type="submit" name="action">Add review<i class="material-icons right">send</i></button>
        <div id="review" class="hide-form">
          <div class="center-transparent col s12">
            <!-- if CURRENT USER is not the POSTER of the TASK, BUT was the NEEDED USER -->
            <%= render 'tasks/review' %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

  <!-- show/hide review form -->
<!--   <div class="row task-timer">
=======

<div class="row task-timer">
>>>>>>> 1d48cf9ac99f6b131084fa699ee83d0b783304ae
  <div class="col s12">
    <div class="card blue-grey darken-1">
        <span id="time">00:00:00</span>
      <div class="card-action">
        <button id="start">Start</button>
        <button id ="stop">Pause</button>
        <button id="reset">End</button>
      </div>
    </div>
  </div>
<<<<<<< HEAD
</div> -->





